dist: trusty
sudo: false

language: cpp

compiler:
  - gcc
  - clang

addons:
  apt:
    packages:
    - texinfo

before_script:
  # - git clone --depth=1 https://git.savannah.gnu.org/git/libjit.git
  - cd $TRAVIS_BUILD_DIR
  - wget http://git.savannah.gnu.org/cgit/lightning.git/snapshot/lightning-2.1.2.tar.gz
  - tar xzf lightning-2.1.2.tar.gz
  - cd lightning-2.1.2 && autoreconf -i && ./configure --prefix=/home/travis/install
  - make && make install
  # - cd ../libjit && ./bootstrap && ./configure --prefix=/home/travis/install
  # - make && make install
  # - find /home/travis/install

script:
  - cd $TRAVIS_BUILD_DIR
  - make clean && make test JIT=sljit
  - ./test
  - make clean && make test JIT=lightning LDFLAGS=-L/home/travis/install/lib CPPFLAGS=-I/home/travis/install/include
  - ./test
